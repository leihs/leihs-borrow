include:
- path: cider-ci/install-ruby_task-component.yml
  submodule: [leihs-ui]

traits:
  JDK 8: true
  Leiningen 2: true
  npm: true

scripts:

  build-leihs-ui-for-borrow:
    start_when:
      install-ruby-passed: {script_key: install-ruby}
    timeout: 10 minutes
    body: ${LEIHS_BORROW_DIR}/leihs-ui/bin/build
    exclusive_executor_resource: build-leihs-ui

  build-borrow-uberjar:
    timeout: 10 Minutes
    exclusive_executor_resource: build-leihs-borrow-jar
    start_when:
      shared ui was built:
        script_key:  build-leihs-ui-for-borrow
    body: ${LEIHS_BORROW_DIR}/bin/build
